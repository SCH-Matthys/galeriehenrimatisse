{% extends 'base.html.twig' %}

{% block title %}Profil{% endblock %}

{% block main %}
    <main id="mainProfil">
        <section id="s-profil">
            <div></div>
            <div>
                <p>Prénom : {{ user.firstName }}</p>
                <p>Nom : {{ user.lastName }}</p>
                <p>Alias d'artiste : {{ user.alias }}</p>
            </div>
        </section>
        <div></div>
        <section id="s-gallery">
            {% if user.gallery == null %}
                <a href="{{ path("app_createGallery") }}" class="btn">Créez votre galerie</a>
            {% else %}
                <a href="{{ path("add_artwork") }}" class="btn">Ajouter une oeuvre à votre galerie</a>
                <div id="artworks">
                {% for artwork in gallery.artworks %}
                    {# <article>
                        {% for image in artwork.artworkImages %}
                            <a href="">
                                <img src="{{ asset('uploads/artworkImages/' ~ image.imageName) }}" alt="{{ artwork.name }}">
                            </a>
                        {% endfor %} #}

                    <article>
                        {% set firstImage = artwork.artworkImages|first %}
                        {% if firstImage %}
                            <a href="{{ path("app_artworkDetails", {"id": artwork.id}) }}">
                                <img src="{{ asset('uploads/artworkImages/' ~ firstImage.imageName) }}" alt="{{ artwork.name }}">
                            </a>
                        {% else %}
                            <p>(Aucune image)</p>
                        {% endif %}


                        {% if is_granted("ROLE_ADMIN") or user.id == artwork.gallery.user.id %}
                        <div>
                            <a href="{{ path("edit_oeuvre", {"id": artwork.id}) }}">Modifier</a>
                            <form method="POST" onsubmit="return confirm('Vous êtes sur de vouloir supprimer cette oeuvr ede votre galerie ? Cliquez sur [ OK ] pour valider la suppression.')"
                                action="{{ path('delete_artwork', {'id': artwork.id}) }}">
                                <input type="hidden" name="_method" value="delete">
                                <input type="hidden" name="_token" value="{{csrf_token('SUP' ~ artwork.id)}}">
                                <input type="submit" id="delete" value="supprimer">
                            </form>
                        </div>
                        {% endif %}
                    </article>
                {% endfor %}
            </div>
            {% endif %}
            
        </section>
    </main>
{% endblock %}